!function(n){n.fn.snake=function(e){n.fn.snake.settings=n.extend({},n.fn.snake.defaults,e);var a=n("<canvas></canvas>",{id:n.fn.snake.settings.id,"class":n.fn.snake.settings.classes,style:"width: "+n.fn.snake.settings.canvasWidth+"px; height: "+n.fn.snake.settings.canvasHeight+"px; background: "+n.fn.snake.settings.canvasBackground+"; "+n.fn.snake.settings.canvasStyle});return a.attr("width",n.fn.snake.settings.canvasWidth+"px"),a.attr("height",n.fn.snake.settings.canvasHeight+"px"),a.appendTo(this),n.fn.snake.ctx=a[0].getContext("2d"),n.fn.snake.init(),this},n.fn.snake.defaults={id:"snake-canvas",classes:"snake-canvas",canvasBackground:"#ffffff",canvasHeight:250,canvasStyle:"",canvasWidth:250,foodColor:"#ff00000",foodBorder:"#ffffff",snakeColor:"#000000",snakeBorder:"#ffffff",snakeLength:5,startOnLoad:!1,defaultDirection:"right",cellWidth:10,wallColision:!0,timer:60,callback:function(){n.fn.snake.init()}},n.fn.snake.createSnake=function(){var e=n.fn.snake.settings;n.fn.snake.snakeArray=[];for(var a=e.snakeLength;a>0;a--)n.fn.snake.snakeArray.push({x:a,y:0})},n.fn.snake.createFood=function(){for(var e=n.fn.snake.settings,a=n.fn.snake.snakeArray,s=Math.round(Math.random()*(e.canvasWidth-e.cellWidth)/e.cellWidth),t=Math.round(Math.random()*(e.canvasHeight-e.cellWidth)/e.cellWidth),f=0;f<a.length;f++)if(a[f].x==s&&a[f].y==t)return n.fn.snake.createFood();n.fn.snake.food={x:s,y:t}},n.fn.snake.init=function(){var e=n.fn.snake.settings;n.fn.snake.running=!1,n.fn.snake.direction=e.defaultDirection,n.fn.snake.createSnake(),n.fn.snake.createFood(),e.startOnLoad===!0&&n.fn.snake.start()},n.fn.snake.start=function(){n.fn.snake.score=0,"undefined"!=typeof n.fn.snake.game&&clearInterval(n.fn.snake.game),n.fn.snake.game=setInterval(function(){n.fn.snake.process()},n.fn.snake.settings.timer),n.fn.snake.running=!0},n.fn.snake.pause=function(){clearInterval(n.fn.snake.game),n.fn.snake.running=!1},n.fn.snake.resume=function(){n.fn.snake.game=setInterval(function(){n.fn.snake.process()},n.fn.snake.settings.timer),n.fn.snake.running=!0},n.fn.snake.process=function(){var e=n.fn.snake.ctx,a=n.fn.snake.settings,s=n.fn.snake.snakeArray,t=n.fn.snake.direction,f=n.fn.snake.food;e.fillStyle=a.canvasBackground,e.fillRect(0,0,a.canvasWidth,a.canvasHeight);var i=s[0].x,r=s[0].y;if("up"==t?r--:"down"==t?r++:"left"==t?i--:"right"==t&&i++,n.fn.snake.hasBiteHimself(i,r)||n.fn.snake.inCollision(i,r))return void a.callback();if(i==f.x&&r==f.y){var k={x:i,y:r};n.fn.snake.score++,n.fn.snake.createFood()}else{var k=n.fn.snake.snakeArray.pop();k.x=i,k.y=r}n.fn.snake.snakeArray.unshift(k),n.fn.snake.displaySnake(),n.fn.snake.displayFood(),n.fn.snake.displayScore()},n.fn.snake.hasBiteHimself=function(e,a){for(var s=n.fn.snake.snakeArray,t=0;t<s.length;t++)if(s[t].x==e&&s[t].y==a)return!0;return!1},n.fn.snake.inCollision=function(e,a){var s=n.fn.snake.settings;return s.wallCollision===!1?!1:0>e||e>=s.canvasWidth/s.cellWidth||0>a||a==s.canvasHeight/s.cellWidth},n.fn.snake.displaySnake=function(){var e=n.fn.snake.ctx,a=n.fn.snake.settings,s=n.fn.snake.snakeArray;e.fillStyle=a.snakeColor,e.strokeStyle=a.snakeBorder;for(var t=0;t<s.length;t++)e.fillRect(s[t].x*a.cellWidth,s[t].y*a.cellWidth,a.cellWidth,a.cellWidth),e.strokeRect(s[t].x*a.cellWidth,s[t].y*a.cellWidth,a.cellWidth,a.cellWidth)},n.fn.snake.displayFood=function(){var e=n.fn.snake.ctx,a=n.fn.snake.settings,s=n.fn.snake.food;e.fillStyle=a.foodColor,e.fillRect(s.x*a.cellWidth,s.y*a.cellWidth,a.cellWidth,a.cellWidth),e.strokeStyle=a.foodBorder,e.strokeRect(s.x*a.cellWidth,s.y*a.cellWidth,a.cellWidth,a.cellWidth)},n.fn.snake.displayScore=function(){var e="Score: "+n.fn.snake.score;n.fn.snake.ctx.fillText(e,5,n.fn.snake.settings.canvasHeight-5)},n(document).keydown(function(e){if(n.fn.snake.running===!0){var a=e.which;"37"==a&&"right"!=n.fn.snake.direction?n.fn.snake.direction="left":"38"==a&&"down"!=n.fn.snake.direction?n.fn.snake.direction="up":"39"==a&&"left"!=n.fn.snake.direction?n.fn.snake.direction="right":"40"==a&&"up"!=n.fn.snake.direction&&(n.fn.snake.direction="down")}})}(jQuery);